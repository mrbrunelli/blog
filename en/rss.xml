<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Blog Matheus Brunelli, programação, carreira e muito Javascript! Blog</title>
        <link>https://mrbrunelli.github.io/blog/en/</link>
        <description>Blog Matheus Brunelli, programação, carreira e muito Javascript! Blog</description>
        <lastBuildDate>Thu, 17 Feb 2022 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <item>
            <title><![CDATA[Como foi construir um validador de objetos?]]></title>
            <link>https://mrbrunelli.github.io/blog/en/como-foi-construir-um-validador-de-objetos</link>
            <guid>como-foi-construir-um-validador-de-objetos</guid>
            <pubDate>Thu, 17 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[Primeiramente, por que contruí um pacote de validar objetos, sendo que o npm está cheio deles...]]></description>
            <content:encoded><![CDATA[<p><img alt="Logo NPM" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhwAAADSAgMAAAB87fECAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACVBMVEUAAADLODf///8EXxL6AAAAAXRSTlMAQObYZgAAAAFiS0dEAmYLfGQAAAAHdElNRQfhCAkCAi0o2YxVAAAAwElEQVR42u3asRGAIAxAURr3s7FxPxumtLHihMt5QS3er0PyBqBs/6hwcHBwcHBwcHBwcHBwcHCkO/Y66rimhkM1tKqzmYODg4ODg4ODg4ODg4ODY7qjOdxxNG+frOLg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4OCY7Aj9M+Dg4ODg4ODg4ODg4ODg4PjKEev+cEYcHBwcHBwcHBwcHBwcHByJjlDLcMda3oqDg4ODg4ODg4ODg4ODgyPSCV7wh+HNgMmcAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE3LTA4LTA5VDAyOjAyOjQ0KzAwOjAw39Y9SwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNy0wOC0wOVQwMjowMjo0NCswMDowMK6LhfcAAAAASUVORK5CYII=" width="540" height="210"></p><p>Eai galera, tudo bem com vocês? Espero que sim.
Hoje gostaria de compartilhar como <strong>criei meu primeiro pacote npm</strong>, quais foram minhas motivações e as etapas desde a ideia até o publish.</p><p>Primeiramente, por que contruí um pacote de <strong>validar objetos</strong>, sendo que o npm <strong>está cheio deles?</strong>
Bem, essa decisão foi um pouco difícil, visto que já existe um validador de schemas muito famoso na comunidade, o famigerado <a href="https://www.npmjs.com/package/yup" target="_blank" rel="noopener noreferrer"><strong>Yup</strong></a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vamos-às-motivações">Vamos às motivações<a class="hash-link" href="#vamos-às-motivações" title="Direct link to heading">​</a></h3><p>A primeira motivação foi que, eu sempre quis <strong>criar um pacote npm que não fosse inútil</strong>, mas nunca tinha a oportunidade ou <strong>criatividade</strong> para tal.
Acontece que, durante o trabalho surgiu uma dificuldade de validar alguns campos que a API de um ERP retornava, devido a sua volatilidade.</p><p>Algo mais ou menos assim:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Response do ERP</div><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"serviceName"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"CRUDServiceProvider.loadRecords"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"status"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"pendingPrinting"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"false"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"transactionId"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"6BB89D3B72BEDCE69E51C5698DF3BB23"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"responseBody"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"entities"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"total"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"hasMoreResult"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"false"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"offsetPage"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"offset"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"metadata"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"fields"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">"field"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token property" style="color:#36acaa">"name"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"NUNOTA"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Tá, qual o problema desse retorno? Parece um retorno normal de uma API normal, mas não! A API não retorna status code 40x quando alguma request falha por algum motivo. Ela sempre retorna 200, mas com alguns campos diferentes. Por exemplo:</p><ul><li>Quando a ação não é executada por completo, <strong>o campo "status" retorna "0"</strong>.</li><li>Quando a ação é executada mas não retorna dados, <strong>o campo "status" retorna "1"</strong>, mas <strong>o campo "total" retorna "0"</strong>.</li><li>Alguns endpoints retornam <strong>o campo "responseBody.entities</strong>", outros "<strong>responseBody.fieldsMetaData"</strong>, e consequentemente, toda a árvore de objetos é alterada.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="resposta-de-outro-endpoint-do-mesmo-erp">Resposta de outro endpoint do mesmo ERP<a class="hash-link" href="#resposta-de-outro-endpoint-do-mesmo-erp" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-json theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Response do ERP</div><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"serviceName"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"DbExplorerSP.executeQuery"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"status"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"pendingPrinting"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"false"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"transactionId"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"1BFB4FBFB934D9BE62BD06D5412C5A19"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"tsError"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"tsErrorCode"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"CORE_E03690"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"tsErrorLevel"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"ERROR"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"statusMessage"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Permitido apenas a execu��o de consultas, a instru��o possui 'UPDATE', 'DELETE' ou 'INSERT' e tais comandos n�o s�o permitidos."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Veja que não tem um padrão, <strong>pois dessa vez retornou "status" "0" com um campo novo "statusMessage"</strong>, porém o status code da requisição é 200, de sucesso.</p><p>Como o servidor onde o código fonte estava só suportava Node versão 12, algumas features como <strong>optional chaining</strong> não estavam disponíveis. Dessa forma tive que validar o retorno da API de uma forma muito verbosa:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Validação da response</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> hasERPSuccessResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">status</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"1"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseBody</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseBody</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">entities</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">responseBody</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">entities</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">total</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hasERPSuccessResponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// prossegue...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="ficar-toda-hora-fazendo-as-mesmas-validações-fez-com-que-eu-me-sentisse-um-perfeito-idiota">Ficar toda hora fazendo as mesmas validações fez com que eu me sentisse um perfeito idiota<a class="hash-link" href="#ficar-toda-hora-fazendo-as-mesmas-validações-fez-com-que-eu-me-sentisse-um-perfeito-idiota" title="Direct link to heading">​</a></h3><p>Então comecei a pensar em como eu poderia abstrair esse tipo de validação, mas sem precisar ficar mapeando todas as combinações possíveis da resposta.
Eu queria continuar fazendo o "if", da maneira como faria com o <strong>optional chaining</strong>.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Como seria a validação no Node 14+</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> hasERPSuccessResponse </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">status </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"1"</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  response</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">responseBody</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">entities</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">total </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"0"</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="etapas">Etapas<a class="hash-link" href="#etapas" title="Direct link to heading">​</a></h3><p>Pensei, preciso criar uma função que:</p><ul><li>Receba o objeto a ser validado.</li><li>Receba os campos a serem procurados no objeto.</li><li>Deve validar independente do formato de objeto fornecido.</li><li>Deve validar chave e valor.</li><li>Deve permitir validar campos com nomes iguais, mas em localizações diferentes.</li><li>Deve retornar apenas booleano, nada de exceções ou mensagens.</li></ul><p>Imaginei algo mais ou menos com esse design:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Validador de objetos</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> isValid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">objectValidator</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">"status"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">"response.data.status"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">"response.data.responseBody.entities"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isValid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// prossegue...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Do jeito que montei já estava legal, mas eu precisava validar os valores dos campos também, e então começou a ficar complexo. Comecei a imaginar vários cenários onde minha função quebraria, e comecei a desanimar.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="mas-nunca-desisto-fácil-de-algo">Mas nunca desisto fácil de algo<a class="hash-link" href="#mas-nunca-desisto-fácil-de-algo" title="Direct link to heading">​</a></h3><p>Como estou estudando muito sobre <strong>TDD</strong>, resolvi escrever todos os cenários possíveis no teste, antes mesmo de começar a programar uma linha de código.
Me lembro que quando comecei, o arquivo de testes estava mais ou menos assim:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">objectValidator.test.js</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"objectValidator"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve chamar a função com um objeto no primeiro parâmetro"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve chamar a função com um array de campos no segundo parâmetro"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve retornar falso se algum campo for fornecido incorretamente"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">todo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">"deve retornar falso se um dos campos fornecidos não forem encontrado no objeto"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tdd-me-ensinou-a-resolver-um-problema-por-vez">TDD me ensinou a resolver um problema por vez<a class="hash-link" href="#tdd-me-ensinou-a-resolver-um-problema-por-vez" title="Direct link to heading">​</a></h3><p>Seguindo esse modelo, coloquei todos os possíveis cenários em <strong>TODOS</strong>, e fui implementando um a um.
Já era de noite quando completei meus <strong>TODOS</strong>, e minha função estava totalmente funcional, e muito performática.</p><p>Comecei a criar cenários totalmente caóticos, fornecendo várias vezes os mesmos campos, deixando de informar valores em alguns, e BOOM! <strong>O algoritmo continuou funcionando perfeitamente!</strong></p><p>Nem acreditei que consegui criar algo tão útil em tão pouco tempo. Na manhã seguinte, um sábado muito agradável, resolvi criar uma conta no NPM e publicar a primeira versão funcional. Utilizei o CI do GitHub para garantir que tudo que chegasse à branch <strong>main</strong> estivesse de fato testado.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="para-minha-surpresa">Para minha surpresa<a class="hash-link" href="#para-minha-surpresa" title="Direct link to heading">​</a></h3><p>Domingo de manhã meu pacote já estava com mais de 100 downloads, senti uma euforia tão grande! Meu repositório no GitHub havia sido clonado mais de 50x e visitado por dezenas de pessoas diferentes.
Algo tão simples, passou a ajudar um punhado de pessoas, que <strong>preferiram utilizar meu pacote de 6kb</strong> ao invés do Yup, que contém <strong>inúmeras funcionalidades</strong>.</p><p>Essa foi uma grande experiência pra mim, e de agora em diante, sempre que eu criar algo útil, irei publicar para que outras pessoas também possam utilizar.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tá-mas-como-ficou-a-implementação">Tá, mas como ficou a implementação?<a class="hash-link" href="#tá-mas-como-ficou-a-implementação" title="Direct link to heading">​</a></h3><p>Vou deixar o repo aqui em baixo. Migrei tudo pra Typescript quando tive mais tempo e gerei os arquivos d.ts, pra garantir tipagens para quem está utilizando no Javascript.</p><ul><li><a href="https://github.com/mrbrunelli/object-validator" target="_blank" rel="noopener noreferrer"><strong>Repo GitHub</strong></a></li><li><a href="https://www.npmjs.com/package/@mrbrunelli/object-validator" target="_blank" rel="noopener noreferrer"><strong>Link do NPM</strong></a></li></ul><p>Por hoje é isso, espero que tenha gostado da pequena história, até a próxima!</p>]]></content:encoded>
            <category>npm</category>
            <category>pacote npm</category>
            <category>validator</category>
            <category>validador de objetos</category>
        </item>
        <item>
            <title><![CDATA[Como contornar a dor de escrever um teste unitário?]]></title>
            <link>https://mrbrunelli.github.io/blog/en/como-contornar-a-dor-de-escrever-um-teste-unitário</link>
            <guid>como-contornar-a-dor-de-escrever-um-teste-unitário</guid>
            <pubDate>Thu, 16 Dec 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Acredito que todo mundo concorda que um código sem testes, é um código instável e frágil à mudanças...]]></description>
            <content:encoded><![CDATA[<p><img alt="TDD Banner" src="/blog/en/assets/images/tdd-fbd2a93ec4b76fcef18c1b3a10e68bbf.jpeg" width="535" height="311"></p><p>Salve galera, tudo tranquilo? Esse é meu segundo artigo, e gostaria de compartilhar algo que vem me ajudando muito durante o desenvolvimento de software e na minha própria evolução profissional.</p><p>Estou falando sobre os <strong>testes unitários</strong>. Acredito que todo mundo concorda que um código sem testes, é um código instável e frágil à mudanças. É muito ruim programar no escuro, nós nunca temos certeza que o que estamos desenvolvendo irá funcionar em produção, sem conflitar com as features já existentes.</p><p>Por outro lado, escrever testes para uma feature já implementada pode ser algo muito doloroso, por isso <strong>muita gente prefere correr o risco e deixar o código sem cobertura.</strong></p><p>Mas recentemente venho estudando fortemente uma metodologia que abriu minha mente, o <strong>TDD</strong>, ou em português <strong>"Desenvolvimento guiado por testes"</strong>. No TDD nós criamos o teste primeiro, e só depois criamos a implementação de fato, que fará o teste passar. Isso faz com que nosso código sempre esteja coberto por testes.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="traduzindo">Traduzindo<a class="hash-link" href="#traduzindo" title="Direct link to heading">​</a></h2><p>Se eu quisesse criar uma função que me retornasse o maior número de uma lista em Javascript, utilizando o <strong>TDD</strong> (escrevendo o teste primeiro), eu começaria fazendo algo mais ou menos assim:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Arquivo: pegueOMaiorNumero.test.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Sintaxe de um framework de testes do Javascript</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"pegueOMaiorNumero"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve retornar o maior número de uma lista"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maiorNumero </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pegueOMaiorNumero</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maiorNumero</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Nesse caso, eu forneci uma lista com alguns números, onde o 21 é o maior deles. Mas note que em nenhum momento foi criada a função <strong>pegueOMaiorNumero</strong>. Estou invocando uma função que <strong>ainda não foi criada</strong>, e ainda estou esperando que o resultado seja 21. Nesse caso o teste irá falhar.</p><p>É ai que a brincadeira começa. Quando o teste falha, é sinal de que precisamos implementar a feature que faça esse teste passar.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="então-vamos-lá">Então vamos lá!<a class="hash-link" href="#então-vamos-lá" title="Direct link to heading">​</a></h2><p>Vou criar a função que fará o teste passar:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Arquivo: pegueOMaiorNumero.test.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">pegueOMaiorNumero</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">numeros</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> maior </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> numeros</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">numeros</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> maior</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      maior </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> numeros</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> maior</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"pegueOMaiorNumero"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve retornar o maior número de uma lista"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maiorNumero </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pegueOMaiorNumero</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maiorNumero</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Agora o teste começará a passar. Veja que o algoritmo não ficou dos melhores, mas conseguiu satisfazer o que o teste pediu. Agora que o teste está passando, posso refatorar a função <strong>pegueOMaiorNumero</strong> sem medo, pois ela está coberta por um teste. Caso a função passe a retornar uma string, null, ou um número que não seja o maior, <strong>o teste irá me avisar, reprovando</strong>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="vamos-refatorar-sem-medo">Vamos refatorar, sem medo!<a class="hash-link" href="#vamos-refatorar-sem-medo" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Arquivo: pegueOMaiorNumero.test.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">pegueOMaiorNumero</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">numeros</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">numeros</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">describe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"pegueOMaiorNumero"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"deve retornar o maior número de uma lista"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> maiorNumero </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pegueOMaiorNumero</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">expect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">maiorNumero</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toBe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Pronto, se a gente rodar esse teste, ele irá continuar passando, pois o <strong>Math.max</strong> está fazendo o mesmo que o <strong>laço de repetição</strong> estava fazendo anteriormente, mas de uma maneira mais enxuta. O fato é que, temos confiança de alterar um código que nos fale se a nossa regra de negócios falhou. <strong>É inadmissível</strong> que nossa função <strong>pegueOMariorNumero</strong> retorne um número que não é o maior.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="conclusão">Conclusão<a class="hash-link" href="#conclusão" title="Direct link to heading">​</a></h2><p>Nossa simples feature de retornar o maior número, <strong>esteve durante todo o tempo de desenvolvimento coberta por um teste</strong>. Se a gente fizesse a feature primeiro ao invés do teste, teríamos que testá-la manualmente a cada alteração, printando o resultado no console, até de fato escrever um teste pra ela. Isso seria <strong>cansativo</strong>. O teste é automatizado, ou seja, escrevemos uma única vez, e ele sempre irá assegurar o resultado pra gente.</p><p>Escolhi esse exemplo de algoritmo, pois há várias formas de implementá-lo. Caso você descubra alguma forma mais enxuta que essa apresentada, poderá implementar sem correr o risco de quebrar sua aplicação.</p><p>Como material complementar, recomendo essa live que aconteceu no dia 09/12/2021, e que considero excepcional por <strong>dois motivos: não tem enrolação, e os caras sabem o que estão ensinando.</strong> Por hoje é isso, forte abraço e até a próxima!</p><p><a href="https://youtu.be/sg1zFpNM5Jw" target="_blank" rel="noopener noreferrer"><img src="https://img.youtube.com/vi/sg1zFpNM5Jw/0.jpg" alt="Live TDD na prática - Diego Fernandes e Rodrigo Manguinho"></a></p><ul><li>Repositório código fonte: <a href="https://github.com/mrbrunelli/tdd-pega-o-maior-numero" target="_blank" rel="noopener noreferrer">https://github.com/mrbrunelli/tdd-pega-o-maior-numero</a></li></ul>]]></content:encoded>
            <category>tdd</category>
            <category>testes</category>
            <category>teste unitário</category>
        </item>
        <item>
            <title><![CDATA[O impacto da educação em minha vida]]></title>
            <link>https://mrbrunelli.github.io/blog/en/o-impacto-da-educação-em-minha-vida</link>
            <guid>o-impacto-da-educação-em-minha-vida</guid>
            <pubDate>Fri, 07 May 2021 00:00:00 GMT</pubDate>
            <description><![CDATA[Meu último emprego antes de me tornar Desenvolvedor em 2019 era de Auxiliar de Produção em uma fábrica aqui da cidade...]]></description>
            <content:encoded><![CDATA[<p><img alt="Education Banner" src="/blog/en/assets/images/education-b10b3c1f8adccbed991bcf30d07ae738.jpeg" width="1400" height="600"></p><p>Ontem enquanto organizava minha gaveta, me deparei com minha certidão de casamento, onde estava escrito na primeira linha:</p><blockquote><p>MATHEUS RICARDO BRUNELLI, brasileiro, de profissão: Auxiliar de Produção. Ano 2018.</p></blockquote><p>Meu último emprego antes de me tornar Desenvolvedor em 2019 era de Auxiliar de Produção em uma fábrica aqui da cidade. O trabalho era muito simples, porem muito desgastante, Dorflex e Torsilax (não é propaganda) faziam parte da minha intensa semana.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="tecnologia-uma-realidade-crescente">Tecnologia, uma realidade crescente<a class="hash-link" href="#tecnologia-uma-realidade-crescente" title="Direct link to heading">​</a></h3><p>Certo dia a fábrica inteira parou para ouvir o anúncio dos coordenadores das faculdades da região, e foi anunciado dentre os demais cursos o curso de Sistemas para Internet, e a fala do coordenador <a href="https://www.linkedin.com/in/profburnes" target="_blank" rel="noopener noreferrer">Anderson Burnes</a> (que eu já conhecia) foi muito convincente, pois naquele ano várias empresas estavam passando por transformação digital, e estavam precisando de desenvolvedores qualificados, e os salários eram bem diferentes da minha realidade.</p><p>Eu trabalhava muito para conseguir sustentar a minha família (eu, esposa e os doguinhos) e mesmo assim não era suficiente, um pneu furado ou uma gripe eram suficientes para acabar com nossas economias do mês rsrs.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="educação-um-investimento-muito-rentável">Educação, um investimento muito rentável<a class="hash-link" href="#educação-um-investimento-muito-rentável" title="Direct link to heading">​</a></h3><p>Eu sabia que o único caminho para uma mudança de vida, era através da educação. E naquele ano estudei muito para o Enem, e consegui uma Bolsa ProUni para o curso de Sistemas para Internet na <a href="https://www.alfaumuarama.edu.br/fau" target="_blank" rel="noopener noreferrer">UniAlfa</a>.</p><p>Me lembro que dessa vez eu não estava apenas fazendo um curso por fazer, eu estava colocando todas minhas energias em algo que eu acreditava poder mudar minha vida.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="esforço-no-lugar-certo">Esforço no lugar certo<a class="hash-link" href="#esforço-no-lugar-certo" title="Direct link to heading">​</a></h3><p>Durante os primeiros semestres, percebi que existiam muitos caminhos para seguir profissão, alguns bem confusos, e eu precisaria ter foco em algo para poder me destacar. Comecei a pesquisar por tecnologias que me ajudariam a entrar no mercado mais rápido, pois essa era minha maior motivação.</p><p>Quando obtive um mínimo de confiança nessas tecnologias, pedi demissão do meu emprego na fábrica, para que eu pudesse me dedicar aos estudos de forma integral. Minha família ficou com muito medo da minha decisão, afinal, não haviam garantias que eu conseguiria entrar na área, antes da nossa minúscula reserva financeira acabar.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="fé-foco-e-medo">Fé, foco e medo<a class="hash-link" href="#fé-foco-e-medo" title="Direct link to heading">​</a></h3><p>Foram esses três elementos que me acompanharam nessa transição. Fé porque nós não enxergamos o amanhã. Foco porque o tempo é escasso. Medo porque ele funciona como uma balança, quanto mais arriscado, mais sentimos medo.</p><p>Como todo trabalhado duro traz recompensas, a minha chegou aos 45 do segundo tempo, quando só restavam algumas moedinhas no cofre. Consegui meu primeiro emprego na área, graças ao networking (vou escrever um artigo só desse cara) e ao meu esforço é claro.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="mercado-aquecido">Mercado aquecido<a class="hash-link" href="#mercado-aquecido" title="Direct link to heading">​</a></h3><p>Se eu pudesse deixar um conselho para quem está começando, seria:</p><blockquote><p>Estude, e faça de tudo para tentar entrar no mercado. Tenha foco, e invista seu tempo estudando o que te dará retorno.</p></blockquote><p>Nem só de teoria vive o programador. Essa é uma profissão muito prática, quanto mais se exercita, mais se aprende. Os melhores exercícios são problemas reais de uma empresa. Mesmo que ganhando pouco no começo, trabalhar com problemas reais não tem preço, essa experiência não pode ser adquirida de outra forma.</p><h3 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="considerações-finais">Considerações finais<a class="hash-link" href="#considerações-finais" title="Direct link to heading">​</a></h3><p>Esse foi meu primeiro artigo, fiquei muito empolgado ao escrevê-lo. Se você chegou até aqui, meus agradecimentos. Espero que tenha sido útil para você.</p><p>Forte abraço, e até o próximo artigo!</p>]]></content:encoded>
            <category>educação</category>
            <category>a importância da educação</category>
            <category>aprendizado</category>
        </item>
    </channel>
</rss>